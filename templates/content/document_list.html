{% extends 'base.html' %}

{% block title %}Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª{% endblock %}

{% block content %}
<div class="documents-container">
  <div class="documents-card">
    
    <div class="header-row">
      <h2>ğŸ“„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</h2>
      {% if role == 'admin' or role == 'staff' %}

        <a href="{% url 'upload_document' %}" class="add-doc-btn">+ Ø±ÙØ¹ Ù…Ø³ØªÙ†Ø¯ Ø¬Ø¯ÙŠØ¯</a>
      {% endif %}

    </div>

<!-- Ø§Ù„Ø¨Ø­Ø« -->
<form method="get" class="text-end mb-3">
  <div style="display: inline-flex; gap: 8px;">
    <input type="text" name="q" value="{{ query }}" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙ†Ø¯..." class="form-control" style="max-width: 280px;">
    <button type="submit" class="btn btn-primary">Ø¨Ø­Ø«</button>
  </div>
</form>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµØ¯ÙŠØ± -->
    <div class="export-buttons">
      <a href="#" class="btn btn-outline-secondary">ğŸ“„ ØªØµØ¯ÙŠØ± PDF</a>
      <a href="#" class="btn btn-outline-success">ğŸ“Š ØªØµØ¯ÙŠØ± Excel</a>
    </div>

    <!-- Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
    <div class="table-wrapper">
      <table class="documents-table">
        <thead>
          <tr>
            <th>Ù…</th>
            <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
            <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
            <th>ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨ÙˆØ§Ø³Ø·Ø©</th>
            <th>Ø§Ù„ÙˆØµÙˆÙ„</th>
            <th>Ø¹Ø±Ø¶</th>
            <th>ØªØ­Ù…ÙŠÙ„</th>
            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</th>
            {% if role == 'admin' %}
              <th>Ø­Ø°Ù</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for doc in documents %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ doc.title }}</td>
            <td>{{ doc.client|default:"â€”" }}</td>
            <td>{{ doc.uploaded_by|default:"â€”" }}</td>
            <td>{{ doc.get_access_level_display }}</td>
            <td>
              {% if doc.can_download and doc.file_url %}
                {% if doc.is_image %}
                  <a href="{{ doc.file_url }}" target="_blank" class="btn btn-outline-info btn-sm">Ø¹Ø±Ø¶</a>
                {% elif doc.is_pdf %}
                  <a href="{{ doc.file_url }}" target="_blank" class="btn btn-outline-info btn-sm">Ø¹Ø±Ø¶ PDF</a>
                {% else %}
                  <span class="text-muted">ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…</span>
                {% endif %}
              {% else %}
                <span class="text-muted">ØºÙŠØ± Ù…ØµØ±Ø­</span>
              {% endif %}
            </td>
            <td>
              {% if doc.can_download and doc.file_url %}
                <a href="{{ doc.file_url }}" download class="btn btn-outline-primary btn-sm">ØªØ­Ù…ÙŠÙ„</a>
              {% else %}
                <span class="text-muted">ØºÙŠØ± Ù…ØµØ±Ø­</span>
              {% endif %}
            </td>
            <td>{{ doc.created_at|date:"Y-m-d" }}</td>
            {% if role == 'admin' %}
            <td>
              <form method="post" action="{% url 'delete_document' document_id=doc.id %}" onsubmit="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ');">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm">ğŸ—‘</button>
              </form>
            </td>
            {% endif %}
          </tr>
          {% empty %}
          <tr>
            <td colspan="9" class="empty-row">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
body {
  background-color: #F0F4F8;
  font-family: 'Tajawal', sans-serif;
}

.documents-container {
  display: flex;
  justify-content: center;
  padding-top: 80px;
  padding-bottom: 40px;
}

.documents-card {
  background: #ffffff;
  padding: 30px 25px;
  border-radius: 20px;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
  width: 100%;
  max-width: 1000px;
  color: #2F4157;
}

.header-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.add-doc-btn {
  background: linear-gradient(135deg, #2EC6F3, #5DE6A9);
  color: white;
  padding: 8px 15px;
  border-radius: 8px;
  text-decoration: none;
  font-size: 0.95rem;
  transition: background 0.3s;
}

.add-doc-btn:hover {
  opacity: 0.9;
}

.search-bar {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-bottom: 20px;
}

.search-input {
  max-width: 300px;
  display: inline-block;
}

.export-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-bottom: 20px;
}

.table-wrapper {
  overflow-x: auto;
}

.documents-table {
  width: 100%;
  border-collapse: collapse;
}

.documents-table th,
.documents-table td {
  padding: 12px;
  text-align: center;
  border-bottom: 1px solid #e0e6ed;
}

.documents-table thead {
  background-color: #EAF7FA;
}

.documents-table tbody tr:hover {
  background-color: #f5f9fc;
}

.empty-row {
  text-align: center;
  color: #777;
  font-size: 0.95rem;
}
</style>
{% endblock %}
